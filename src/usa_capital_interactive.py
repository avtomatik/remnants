#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Sun Apr  2 13:27:12 2023

@author: green-machine
"""


import pandas as pd

from remnants.src.lib.combine import combine_capital_combined_archived
from remnants.src.plot_capital_retirement import (plot_capital_acquisition,
                                                  plot_capital_retirement)

# =============================================================================
# projectCapitalAcquisitions.py
# =============================================================================
'''Project: Capital Acquisitions'''


def transform_call(df):
    # df = combine_local().pipe(transform_local)
    _df = df.dropna()
    # =========================================================================
    # Investment
    # =========================================================================
    I = _df.iloc[:, 1].mul(_df.iloc[:, 3]).div(_df.iloc[:, 2])
    # =========================================================================
    # Product
    # =========================================================================
    Y = _df.iloc[:, 3]
    YN = _df.iloc[:, 2]
    # =========================================================================
    # Max: Product
    # =========================================================================
    YM = _df.iloc[:, 3].div(_df.iloc[:, 4]).mul(100)
    # =========================================================================
    # Fixed Assets, End-Period, Not Adjusted
    # =========================================================================
    C = _df.iloc[:, 6].mul(_df.iloc[:, 3]).div(_df.iloc[:, 2])
    L = _df.iloc[:, 7]
    plot_capital_acquisition(I, Y, YN, YM, C, L)


# =============================================================================
# 1967
# =============================================================================
# start = 38
combine_capital_combined_archived().pipe(transform_call, start=38)
# =============================================================================
# Data Fetch: Run 'projectCapital.py'
# =============================================================================


kwargs = {
    'filepath_or_buffer': 'archive project CapitalAcquisitionsRetirement.csv',
    'skiprows': range(1, 23)
}
df = pd.read_csv(**kwargs)
df['period'] = df['period'].astype(int)
# =============================================================================
# capital_retirement.yaml
# =============================================================================
T = df.iloc[:, 0]
# =============================================================================
# Investment
# =============================================================================
I = df.iloc[:, 1].mul(df.iloc[:, 3]).div(df.iloc[:, 2])
# =============================================================================
# Product
# =============================================================================
Y = df.iloc[:, 3]
YN = df.iloc[:, 2]
# =============================================================================
# Max: Product
# =============================================================================
# YM = df.iloc[:, 3].div(df.iloc[:, 4]).div(100)
# Fixed Assets, End-Period, Not Adjusted
C = df.iloc[:, 6].mul(df.iloc[:, 3]).div(df.iloc[:, 2])
L = df.iloc[:, 7]
# =============================================================================
# C = df.iloc[:, 5].mul(df.iloc[:, 3]).div(df.iloc[:, 2])
# =============================================================================
# =============================================================================
# L = df.iloc[:, 8]
# =============================================================================
# =============================================================================
# Replaced with
# =============================================================================
# =============================================================================
# C = df.iloc[:, 6].mul(df.iloc[:, 3]).div(df.iloc[:, 2])
# =============================================================================
# =============================================================================
# L = df.iloc[:, 7]
# =============================================================================

plot_capital_retirement(I, Y, YN, C, L)
