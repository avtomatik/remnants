#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Mar  9 20:53:51 2022

@author: Alexander Mikhailov
"""
from thesis.src.lib.plot import plot_cobb_douglas, plot_cobb_douglas_3d
from thesis.src.lib.stockpile import stockpile_usa_hist
from thesis.src.lib.transform import transform_cobb_douglas

# ================================================================================
# cobb_douglas_archived.py
# ================================================================================

"""
Created on Wed Feb  5 22:19:02 2020

@author: Alexander Mikhailov
"""


# ================================================================================
# thesis_project.py
# ================================================================================

"""
Created on Tue Mar 10 22:29:22 2020

Thesis Project

@author: Alexander Mikhailov
"""


# =============================================================================
# projectCobbDouglasRegression.py
# =============================================================================
# =============================================================================
# Project: Determining of Coefficients of Cobb--Douglas Data Regression
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].iloc[:, [3, 4]].pipe(
    plot_lab_cap_inty_lab_prty_closure
)


# =============================================================================
# usa_cobb_douglas0001.py
# =============================================================================
# =============================================================================
# Cobb--Douglas Algorithm as per C.W. Cobb, P.H. Douglas. A Theory of Production, 1928
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(plot_cobb_douglas)


# =============================================================================
# usa_cobb_douglas0002.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(plot_cobb_douglas_3d)


# =============================================================================
# usa_cobb_douglas0003.py
# =============================================================================
# =============================================================================
# The Revised Index of Physical Production for All Manufacturing In the United States, 1899--1926
# =============================================================================
YEAR_BASE = 1899
plot_cobb_douglas(
    *combine_cobb_douglas(5).iloc[:, [0, 1, -1]].pipe(
        transform_cobb_douglas, YEAR_BASE
    ),
    get_fig_map_us_ma(YEAR_BASE)
)


# =============================================================================
# usa_cobb_douglas0004.py
# =============================================================================
YEAR_BASE = 1899
plot_cobb_douglas_alt(
    *combine_cobb_douglas(4).pipe(
        transform_cobb_douglas_alt, YEAR_BASE
    ),
    get_fig_map(YEAR_BASE)
)


# =============================================================================
# usa_cobb_douglas0005.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, YEAR_BASE
)[0].iloc[:, [0, 2]].pipe(
    plot_turnover_take_one
)


df = usa_cobb_douglas0011()
# =============================================================================
# usa_cobb_douglas0012.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(plot_lab_prod_polynomial)
# =============================================================================
# usa_cobb_douglas0013.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(calculate_curve_fit_params)
# =============================================================================
# usa_cobb_douglas0014.py
# =============================================================================
# =============================================================================
# TODO: Revise Fixed Assets Turnover Approximation with Lasso
# =============================================================================
YEAR_BASE = 1899
_df, _params = df.pipe(transform_cobb_douglas, year_base=YEAR_BASE)
_df.iloc[:, [6]].pipe(plot_turnover)


# =============================================================================
# projectUSA0001.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 05 October 2012
# =============================================================================


# =============================================================================
# projectUSA0002.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 23 November 2012
# =============================================================================


# =============================================================================
# projectUSA0003.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 16 June 2013
# =============================================================================


# =============================================================================
# projectUSA0005.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 15 June 2015
# =============================================================================


# =============================================================================
# projectUSA0007.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 17 February 2013
# =============================================================================


# =============================================================================
# projectUSABEAnKurenkovYuV.py
# =============================================================================
# =============================================================================
# Project: BEA Data Compared with Kurenkov Yu.V. Data
# =============================================================================


# =============================================================================
# uscb_manufacturing.py
# =============================================================================


# =============================================================================
# usa_cobb_douglas0002.py
# =============================================================================


# =============================================================================
# usa_cobb_douglas0003.py
# =============================================================================
# =============================================================================
# Census Manufacturing Series
# =============================================================================

uscb_metals()
# =============================================================================
# usa_cobb_douglas0004.py
# =============================================================================

uscb_commodities()

# =============================================================================
# usa_cobb_douglas0005.py
# =============================================================================
# =============================================================================
# Census Immigration
# =============================================================================

ARCHIVE_NAME = 'dataset_uscb.zip'
SERIES_IDS = dict.fromkeys(
    map(
        lambda _: f'C{_:04n}', itertools.chain(
            range(91, 102),
            range(103, 110),
            range(111, 116),
            range(117, 120),
        )
    ),
    ARCHIVE_NAME
)
stockpile_usa_hist(SERIES_IDS).pipe(
    transform_sum, name="C0089"
).pipe(plot_uscb_immigration)

# =============================================================================
# usa_cobb_douglas0006.py
# =============================================================================
# =============================================================================
# Census Employment Series
# =============================================================================

combine_uscb_unemployment_hours_worked().pipe(
    plot_uscb_unemployment_hours_worked
)

combine_uscb_employment_conflicts().pipe(plot_uscb_employment_conflicts)

# =============================================================================
# usa_cobb_douglas0007.py
# =============================================================================

SERIES_IDS = {
    # =========================================================================
    # Census Gross National Product Series
    # =========================================================================
    'F0003': 'dataset_uscb.zip', 'F0004': 'dataset_uscb.zip'
}
df = stockpile_usa_hist(SERIES_IDS).truncate(before=1889)
df.div(df.iloc[0, :]).mul(100).pipe(plot_uscb_gnp)

# =============================================================================
# usa_cobb_douglas0008.py
# =============================================================================

uscb_farm_lands()
# =============================================================================
# usa_cobb_douglas0009.py
# =============================================================================


# =============================================================================
# usa_cobb_douglas0010.py
# =============================================================================

SERIES_IDS = {
    # =========================================================================
    # Census Money Supply Aggregates
    # =========================================================================
    'X0410': 'dataset_uscb.zip', 'X0414': 'dataset_uscb.zip', 'X0415': 'dataset_uscb.zip'
}
YEAR_BASE = 1915
df = stockpile_usa_hist(SERIES_IDS)
df.div(df.loc[YEAR_BASE, :]).mul(100).pipe(plot_uscb_money_stock)


# =============================================================================
# usa_cobb_douglasHSUSFinancialMarketsnInstitutions.py
# =============================================================================
plot_uscb_finance()
