#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Mar  9 20:53:51 2022

@author: Alexander Mikhailov
"""
from thesis.src.lib.plot import plot_cobb_douglas, plot_cobb_douglas_3d
from thesis.src.lib.stockpile import stockpile_usa_hist
from thesis.src.lib.transform import transform_cobb_douglas

# ================================================================================
# cobb_douglas_archived.py
# ================================================================================

"""
Created on Wed Feb  5 22:19:02 2020

@author: Alexander Mikhailov
"""
# =========================================================================
# Project I. Archived
# =========================================================================
# =============================================================================
# Project II. Scipy Signal Median Filter, Non-Linear Low-Pass Filter
# =============================================================================

# ================================================================================
# project_cobb_douglas_complex.py
# ================================================================================

"""
Created on Sun Mar 15 16:17:13 2020

@author: Alexander Mikhailov
"""
# =========================================================================
# Project I. Archived
# =========================================================================
# ================================================================================
# project_usa_bea.py
# ================================================================================

"""
Created on Thu Jan  9 21:17:48 2020

@author: Alexander Mikhailov
"""


# =========================================================================
# Project IX. USA BEA
# =========================================================================
usa_bea()

# ================================================================================
# project_usa_census.py
# ================================================================================

"""
Created on Sat Jan 18 00:13:17 2020

@author: Alexander Mikhailov
"""


uscb()

# ================================================================================
# project_usa_census_j0014.py
# ================================================================================
# =========================================================================
# Project XI. USA Census J14
# =========================================================================
uscb_manufacturing_complex()

# ================================================================================
# thesis_project.py
# ================================================================================

"""
Created on Tue Mar 10 22:29:22 2020

Thesis Project

@author: Alexander Mikhailov
"""


# =============================================================================
# Project III. Capital Interactive
# =============================================================================
# =============================================================================
# Alpha: Capital Retirement Ratio
# Pi: Investment to Capital Conversion Ratio
# =============================================================================
# =============================================================================
# Project: Interactive Capital Acquisitions
# =============================================================================
# =============================================================================
# capital_acquisitions.yaml
# =============================================================================
# =============================================================================
# Project: Interactive Capital Retirement
# =============================================================================
# =============================================================================
# capital_retirement.yaml
# =============================================================================


# =============================================================================
# Project IV. Cobb--Douglas
# =============================================================================
# =============================================================================
# project_cobb_douglas_complex.py
# =============================================================================
# =============================================================================
# Project V. Cobb--Douglas CAN
# =============================================================================
# =============================================================================
# project_cobb_douglas_can.py
# =============================================================================
# =============================================================================
# Project VI. Elasticity
# =============================================================================


# =============================================================================
# Project VII. Lash-Up Spline
# =============================================================================

# =============================================================================
# Project VIII. Complex
# =============================================================================
usa_complex()

# =========================================================================
# Project IX. USA BEA
# =========================================================================
usa_bea()

# =============================================================================
# project_usa_bea.py
# =============================================================================
# =============================================================================
# Project X. USA Census
# =============================================================================
# =============================================================================
# project_usa_census.py
# =============================================================================
# =========================================================================
# Project XI. USA Census J14
# =========================================================================
uscb_manufacturing_complex()
# =============================================================================
# Project XII. USA Douglas & Kendrick
# =============================================================================
"""
Created on Sun Mar 15 16:17:13 2020
@author: Alexander Mikhailov
"""

# =============================================================================
# Project IV. Cobb--Douglas
# =============================================================================
cobb_douglas_complex()
# ================================================================================
# project_usa_bea.py
# ================================================================================

"""
Created on Thu Jan  9 21:17:48 2020

@author: Alexander Mikhailov
"""


# =========================================================================
# Project IX. USA BEA
# =========================================================================
usa_bea()

# ================================================================================
# project_usa_census.py
# ================================================================================

"""
Created on Sat Jan 18 00:13:17 2020

@author: Alexander Mikhailov
"""


uscb()

# ================================================================================
# project_usa_census_j0014.py
# ================================================================================

"""
Created on Sat Nov 16 20:45:44 2019

@author: Alexander Mikhailov
"""


# =========================================================================
# Project XI. USA Census J14
# =========================================================================
uscb_manufacturing_complex()


# ================================================================================
# thesis_project.py
# ================================================================================

"""
Created on Tue Mar 10 22:29:22 2020

Thesis Project

@author: Alexander Mikhailov
"""


# =========================================================================
# Project I. Approximation
# =========================================================================


# =========================================================================
# Project II. Capital
# =========================================================================

# =============================================================================
# Project III. Capital Interactive
# =============================================================================
# =============================================================================
# Alpha: Capital Retirement Ratio
# Pi: Investment to Capital Conversion Ratio
# =============================================================================
# =============================================================================
# Project: Interactive Capital Acquisitions
# =============================================================================
# =============================================================================
# capital_acquisitions.yaml
# =============================================================================
# =============================================================================
# Project: Interactive Capital Retirement
# =============================================================================
# =============================================================================
# capital_retirement.yaml
# =============================================================================


# =============================================================================
# Project IV. Cobb--Douglas
# =============================================================================
cobb_douglas_complex()


# =============================================================================
# Project V. Cobb--Douglas CAN
# =============================================================================
# cobb_douglas_can.py

# =============================================================================
# Project VI. Elasticity
# =============================================================================


# =============================================================================
# Project VII. Lash-Up Spline
# =============================================================================

# =============================================================================
# Project VIII. Complex
# =============================================================================
usa_complex()

# =========================================================================
# Project IX. USA BEA
# =========================================================================
usa_bea()


# =============================================================================
# Project X. USA Census
# =============================================================================

uscb()

# =========================================================================
# Project XI. USA Census J14
# =========================================================================
uscb_manufacturing_complex()


# =========================================================================
# Project XII. USA Douglas & Kendrick
# =========================================================================


# =============================================================================
# projectCobbDouglasRegression.py
# =============================================================================
# =============================================================================
# Project: Determining of Coefficients of Cobb--Douglas Data Regression
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].iloc[:, [3, 4]].pipe(
    plot_lab_cap_inty_lab_prty_closure
)


# =============================================================================
# usa_cobb_douglas0001.py
# =============================================================================
# =============================================================================
# Cobb--Douglas Algorithm as per C.W. Cobb, P.H. Douglas. A Theory of Production, 1928
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(plot_cobb_douglas)


# =============================================================================
# usa_cobb_douglas0002.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(plot_cobb_douglas_3d)


# =============================================================================
# usa_cobb_douglas0003.py
# =============================================================================
# =============================================================================
# The Revised Index of Physical Production for All Manufacturing In the United States, 1899--1926
# =============================================================================
YEAR_BASE = 1899
plot_cobb_douglas(
    *combine_cobb_douglas(5).iloc[:, [0, 1, -1]].pipe(
        transform_cobb_douglas, YEAR_BASE
    ),
    get_fig_map_us_ma(YEAR_BASE)
)


# =============================================================================
# usa_cobb_douglas0004.py
# =============================================================================
YEAR_BASE = 1899
plot_cobb_douglas_alt(
    *combine_cobb_douglas(4).pipe(
        transform_cobb_douglas_alt, YEAR_BASE
    ),
    get_fig_map(YEAR_BASE)
)


# =============================================================================
# usa_cobb_douglas0005.py
# =============================================================================
YEAR_BASE = 1899
stockpile_cobb_douglas().pipe(
    transform_cobb_douglas, YEAR_BASE
)[0].iloc[:, [0, 2]].pipe(
    plot_turnover_take_one
)


df = usa_cobb_douglas0011()
# =============================================================================
# usa_cobb_douglas0012.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(plot_lab_prod_polynomial)
# =============================================================================
# usa_cobb_douglas0013.py
# =============================================================================
YEAR_BASE = 1899
combine_cobb_douglas().pipe(
    transform_cobb_douglas, year_base=YEAR_BASE
)[0].pipe(calculate_curve_fit_params)
# =============================================================================
# usa_cobb_douglas0014.py
# =============================================================================
# =============================================================================
# TODO: Revise Fixed Assets Turnover Approximation with Lasso
# =============================================================================
YEAR_BASE = 1899
_df, _params = df.pipe(transform_cobb_douglas, year_base=YEAR_BASE)
_df.iloc[:, [6]].pipe(plot_turnover)


# =============================================================================
# projectMultiple.py
# =============================================================================
# =============================================================================
# Project VIII. Complex
# =============================================================================
usa_complex()


# =============================================================================
# projectRollingMean.py
# =============================================================================
SERIES_IDS = {'J0014': 'dataset_uscb.zip'}
stockpile_usa_hist(SERIES_IDS).pipe(plot_filter_rolling_mean)
# =============================================================================
# projectUSA0001.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 05 October 2012
# =============================================================================
combine_usa_investment_manufacturing().pipe(
    transform_investment_manufacturing
).pipe(
    plot_investment_manufacturing
)

# =============================================================================
# projectUSA0002.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 23 November 2012
# =============================================================================
combine_usa_investment().pipe(transform_investment).pipe(plot_investment)

# =============================================================================
# projectUSA0003.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 16 June 2013
# =============================================================================
combine_usa_manufacturing_money().pipe(
    transform_investment
).pipe(
    plot_manufacturing_money
)

# =============================================================================
# projectUSA0005.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 15 June 2015
# =============================================================================


plot_d(*combine_usa_d().pipe(transform_d))
# =============================================================================
# projectUSA0006.py
# =============================================================================


# =============================================================================
# Census Manufacturing Indexes
# =============================================================================
SERIES_IDS = {
    # =====================================================================
    # Bureau of the Census, 1949, Page 179, J13: National Bureau of Economic Research Index of Physical Output, All Manufacturing Industries.
    # =====================================================================
    'J0013': 'dataset_uscb.zip',
    # =====================================================================
    # Bureau of the Census, 1949, Page 179, J14: Warren M. Persons, Index of Physical Production of Manufacturing
    # =====================================================================
    'J0014': 'dataset_uscb.zip',
    # =====================================================================
    # HSUS 1975 Page 667, P17: Edwin Frickey Series, Indexes of Manufacturing Production
    # =====================================================================
    'P0017': 'dataset_uscb.zip',
}
YEAR_BASE = 1899
df = stockpile_usa_hist(SERIES_IDS)
df.div(df.loc[YEAR_BASE, :]).mul(100).pipe(
    plot_uscb_manufacturing, YEAR_BASE
)

# =============================================================================
# projectUSA0007.py
# =============================================================================
# =============================================================================
# Project: Initial Version Dated: 17 February 2013
# =============================================================================


# =============================================================================
# projectUSABEAnKurenkovYuV.py
# =============================================================================
# =============================================================================
# Project: BEA Data Compared with Kurenkov Yu.V. Data
# =============================================================================


# =============================================================================
# uscb_manufacturing.py
# =============================================================================


# =============================================================================
# usa_cobb_douglas0002.py
# =============================================================================


# =============================================================================
# usa_cobb_douglas0003.py
# =============================================================================
# =============================================================================
# Census Production Series
# =============================================================================

uscb_metals()
# =============================================================================
# usa_cobb_douglas0004.py
# =============================================================================

uscb_commodities()

# =============================================================================
# usa_cobb_douglas0005.py
# =============================================================================
# =============================================================================
# Census Immigration
# =============================================================================

ARCHIVE_NAME = 'dataset_uscb.zip'
SERIES_IDS = {
    f'C{_:04n}': ARCHIVE_NAME
    for _ in itertools.chain(
        range(91, 102),
        range(103, 110),
        range(111, 116),
        range(117, 120),
    )
}
stockpile_usa_hist(SERIES_IDS).pipe(
    transform_sum, name="C0089"
).pipe(plot_uscb_immigration)

# =============================================================================
# usa_cobb_douglas0006.py
# =============================================================================
# =============================================================================
# Census Employment Series
# =============================================================================

combine_uscb_unemployment_hours_worked().pipe(
    plot_uscb_unemployment_hours_worked
)

combine_uscb_employment_conflicts().pipe(plot_uscb_employment_conflicts)

# =============================================================================
# usa_cobb_douglas0007.py
# =============================================================================

SERIES_IDS = {
    # =========================================================================
    # Census Gross National Product Series
    # =========================================================================
    'F0003': 'dataset_uscb.zip', 'F0004': 'dataset_uscb.zip'
}
df = stockpile_usa_hist(SERIES_IDS).truncate(before=1889)
df.div(df.iloc[0, :]).mul(100).pipe(plot_uscb_gnp)

# =============================================================================
# usa_cobb_douglas0008.py
# =============================================================================

uscb_farm_lands()
# =============================================================================
# usa_cobb_douglas0009.py
# =============================================================================


# =============================================================================
# usa_cobb_douglas0010.py
# =============================================================================

SERIES_IDS = {
    # =========================================================================
    # Census Money Supply Aggregates
    # =========================================================================
    'X0410': 'dataset_uscb.zip', 'X0414': 'dataset_uscb.zip', 'X0415': 'dataset_uscb.zip'
}
YEAR_BASE = 1915
df = stockpile_usa_hist(SERIES_IDS)
df.div(df.loc[YEAR_BASE, :]).mul(100).pipe(plot_uscb_money_stock)


# =============================================================================
# usa_cobb_douglasHSUSFinancialMarketsnInstitutions.py
# =============================================================================
plot_uscb_finance()
